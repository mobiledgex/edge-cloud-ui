{"ast":null,"code":"import _classCallCheck from \"/Users/kyungjoon/react_pjt/edge-cloud-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/kyungjoon/react_pjt/edge-cloud-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/kyungjoon/react_pjt/edge-cloud-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/kyungjoon/react_pjt/edge-cloud-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/kyungjoon/react_pjt/edge-cloud-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/kyungjoon/react_pjt/edge-cloud-ui/src/components/stepper/index.js\";\n// https://material-ui.com/components/steppers/\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport * as computeService from '../../services/service_compute_service';\nimport * as ServiceSocket from '../../services/service_webSocket';\nimport store from '../../store';\nimport * as actions from '../../actions';\nvar failFlag = false;\nvar deleteFlag = false;\n\nvar VerticalLinearStepper =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(VerticalLinearStepper, _React$Component);\n\n  function VerticalLinearStepper(props) {\n    var _this;\n\n    _classCallCheck(this, VerticalLinearStepper);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(VerticalLinearStepper).call(this, props));\n\n    _this.receiveInterval = function () {\n      try {\n        var prgDiv = document.getElementById(\"prgBox\");\n\n        if (prgDiv) {\n          prgDiv.scrollTop = prgDiv.scrollHeight;\n        }\n      } catch (e) {}\n\n      var hashName = '';\n      var item = _this.props.item;\n      var resultStream = [];\n      hashName = item.Operator + item.CloudletName;\n      var _step = [];\n      console.log('20191119 getState receiveInterval info === ', _this.props.item.State);\n      var stateStream = _this.props.item.State == 5 ? null : _this.props.getParentProps();\n      console.log('20191119 receiveInterval === ', _this.props, \":_step =\", _step, \":\");\n\n      if (_this.props.item.State == 3 || _this.props.item.State == 7) {\n        if (_this.props.item.ClusterInst && _this.props.item.ClusterInst.indexOf('autocluster') > -1 && _this.props.auto == 'auto') {\n          //computeService.creteTempFile(this.props.item, this.props.site, this.receiveStatusAuto)\n          if (stateStream) _this.setState({\n            steps: _step,\n            activeStep: _step.length - 1\n          });\n        } else {\n          //computeService.creteTempFile(this.props.item, this.props.site, this.receiveStatusData)\n          if (stateStream) _this.setState({\n            steps: _step,\n            activeStep: _step.length - 1\n          });\n        }\n      } else if (_this.props.item.State == 5) {\n        _this.setState({\n          steps: ['Created successfully'],\n          activeStep: 1\n        });\n\n        clearInterval(_this.AlertInterval);\n      } else if (_this.props.item.State == 10 || _this.props.item.State == 12) {\n        if (_this.props.site == 'Cloudlet') {\n          //computeService.creteTempFile(this.props.item, this.props.site, this.receiveStatusData)\n          if (_step.length) _this.setState({\n            steps: _step,\n            activeStep: _step.length - 1\n          });\n        } else {\n          _this.setState({\n            steps: _this.deletePrepare.concat(_step),\n            activeStep: _step.length\n          });\n\n          clearInterval(_this.AlertInterval);\n        }\n      } else {\n        _this.setState({\n          steps: ['Create error'],\n          activeStep: 1\n        });\n      } ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n\n      console.log('20191119 getState stateStream .. ', stateStream, \":\", resultStream);\n\n      if (stateStream) {\n        //resultStream = this.storeData(data.data.stacksData,'createCloudlet', 'result')\n        console.log('20191119 index stateStream .. ', stateStream, \":\", resultStream);\n\n        if (stateStream.length > 0) {\n          console.log('20191119 index receiveInterval hashName and clId.. ', hashName);\n          stateStream.map(function (stat) {\n            console.log('20191119 index receiveInterval hashName and clId...... ', hashName, \":\", stat);\n\n            if (stat['message']) {\n              _step.push(stat['message']);\n            } //\n            // if(!stat['message']) {\n            //\n            //     // refresh\n            //     clearInterval(this.AlertInterval)\n            //     // successfully 가 프로세스의 종료가 아닐 경우가 많음\n            //     this.props.stopInterval('info',stat['message'])\n            //     this.props.alertRefresh(stat['message']);\n            //\n            //\n            // }\n            //\n            // if(stat['message'] && stat['message'].indexOf('result') > -1) {\n            //     // refresh\n            //     this.props.stopInterval('info',stat['message'])\n            //     this.props.alertRefresh(stat['message']);\n            //\n            //     clearInterval(this.AlertInterval)\n            // }\n            //\n            // if(stat['message'] && (stat['message'].indexOf('Failed') > -1 || stat['message'].indexOf('failed') > -1)) {\n            //\n            //     this.props.stopInterval('error',stat['message'])\n            //     this.props.failRefresh(stat['message']);\n            //     clearInterval(this.AlertInterval)\n            // }\n\n          });\n        }\n      }\n    };\n\n    _this.receiveStatusData = function (result, _item) {\n      console.log(\"receiveStatusAuto222\", result, \":::\", _item);\n      var toArray = null;\n      var toJson = null;\n      var stepData = [];\n      var count = 0;\n      toArray = result.data.split('\\n');\n      toArray.pop();\n      toJson = toArray.map(function (str) {\n        return JSON.parse(str);\n      });\n      toJson.map(function (item, i) {\n        if (item.data) {\n          stepData.push(item.data.message); //Created ClusterInst successfully\n          //console.log(\"successfullyzxxx222\",item.data.message,\":::\",item.data.message.toLowerCase().indexOf('created successfully'))\n\n          if (item.data.message.toLowerCase().indexOf('created') > -1 && item.data.message.toLowerCase().indexOf('successfully') > -1 && !deleteFlag) {\n            deleteFlag = true;\n            console.log(\"Created successfullyCreated successfully\");\n            count++;\n\n            if (_item.ClusterInst && _item.ClusterInst.indexOf('autocluster') > -1 && count < 2) {\n              deleteFlag = false;\n              return;\n            }\n\n            ;\n            setTimeout(function () {\n              _this.props.alertRefresh();\n\n              computeService.deleteTempFile(_this.props.item, _this.props.site);\n            }, 2000);\n          } else if (item.data.message.toLowerCase().indexOf('deleted cloudlet successfully') > -1) {\n            deleteFlag = true;\n            console.log(\"Delete successfullyCreated successfully\");\n            setTimeout(function () {\n              _this.props.failRefresh('Deleted cloudlet successfully');\n\n              computeService.deleteTempFile(_this.props.item, _this.props.site);\n            }, 2000);\n          } else if (item.data.message.toLowerCase().indexOf('completed') > -1 && item.data.message.toLowerCase().indexOf('updated') > -1 && !deleteFlag) {\n            deleteFlag = true;\n            console.log(\"Updated AppInst\");\n            setTimeout(function () {\n              _this.props.alertRefresh();\n\n              computeService.deleteTempFile(_this.props.item, _this.props.site);\n            }, 2000);\n          }\n        } else if (item.result && item.result.code == 400 && !failFlag) {\n          console.log(\"failRefreshfailRefreshfailRefresh\");\n          failFlag = true;\n          stepData.push(item.result.message);\n          setTimeout(function () {\n            _this.props.failRefresh(item.result.message);\n\n            computeService.deleteTempFile(_this.props.item, _this.props.site);\n          }, 3000);\n        }\n      });\n      console.log(\"toArraytoArray\", stepData);\n\n      _this.setState({\n        steps: stepData,\n        activeStep: stepData.length - 1\n      });\n    };\n\n    _this.receiveStatusAuto = function (result, _item) {\n      var toArray = null;\n      var toJson = null;\n      var count = 0;\n      var stepData = [];\n      toArray = result.data.split('\\n');\n      toArray.pop();\n      toJson = toArray.map(function (str) {\n        return JSON.parse(str);\n      });\n      toJson.map(function (item, i) {\n        stepData.push(item.data.message);\n\n        if (item.data) {\n          if (item.data.message.toLowerCase().indexOf('created') > -1 && item.data.message.toLowerCase().indexOf('successfully') > -1) {\n            console.log(\"Created successfullyCreated successfully\");\n            count++;\n            setTimeout(function () {\n              if (count == 1) {\n                _this.props.autoRefresh();\n              }\n            }, 1000);\n          }\n        }\n      });\n\n      _this.setState({\n        steps: stepData,\n        activeStep: stepData.length - 1\n      });\n    };\n\n    _this.useStyles = makeStyles(function (theme) {\n      return {\n        root: {\n          width: '90%'\n        },\n        button: {\n          marginTop: theme.spacing(1),\n          marginRight: theme.spacing(1)\n        },\n        actionsContainer: {\n          marginBottom: theme.spacing(2)\n        },\n        resetContainer: {\n          padding: theme.spacing(3)\n        }\n      };\n    });\n    _this.state = {\n      steps: [],\n      classes: null,\n      activeStep: null,\n      _item: {\n        Status: {}\n      }\n    };\n    _this.AlertInterval = null;\n    _this.deletePrepare = ['DeletePrepare', 'Deleting'];\n    return _this;\n  }\n\n  _createClass(VerticalLinearStepper, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.AlertInterval = setInterval(function () {\n        _this2.receiveInterval();\n      }, 2000);\n      this.receiveInterval();\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.setState({\n        _item: this.props.item\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.AlertInterval);\n      deleteFlag = false;\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps, nextContext) {\n      console.log('20191119 index receive props in stepper ---- ', nextProps.item, \"== : ==\", nextProps.site, \"== : stream ?? ==\", nextProps.stateStream);\n\n      if (nextProps.item !== this.props.item) {//console.log('20191119 receive props in stepper ---- ',nextProps.item,\"== : ==\", nextProps.site)\n        //this.setState({steps:nextProps.stateStream,activeStep:nextProps.stateStream.length - 1})\n      }\n    }\n    /*\n    props is ==========>\n    alertRefresh: ƒ ()\n    auto: \"\"\n    autoRefresh: ƒ ()\n    failRefresh: ƒ (msg)\n    item:\n        CloudletLocation: {latitude: 50.110924, longitude: 8.682127}\n        CloudletName: \"frankfurt-eu\"\n        Edit: (6) [\"Region\", \"CloudletName\", \"OperatorName\", \"CloudletLocation\", \"Ip_support\", \"Num_dynamic_ips\"]\n        Ip_support: 2\n        Num_dynamic_ips: 10\n        Operator: \"TDG\"\n        Physical_name: \"frankfurt\"\n        Platform_type: 2\n        Progress: \"\"\n        Region: \"EU\"\n        State: 5\n        Status: {}\n        __proto__: Object\n        site: \"Cloudlet\"\n        stateStream: null\n        ---------------------------\n        cloudletId = serviceBody.cloudlet.key.operator_key.name + serviceBody.cloudlet.key.name;\n    */\n    // receiveInterval = () => {\n    //\n    //     console.log('20191119 index receiveInterval info === ', this.props)\n    //\n    //\n    //\n    // }\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          steps = _this$state.steps,\n          activeStep = _this$state.activeStep;\n      var classes = this.useStyles;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, React.createElement(Stepper, {\n        activeStep: activeStep,\n        orientation: \"vertical\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324\n        },\n        __self: this\n      }, steps.map(function (label, index) {\n        return React.createElement(Step, {\n          key: label,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 326\n          },\n          __self: this\n        }, React.createElement(StepLabel, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 327\n          },\n          __self: this\n        }, label));\n      })));\n    }\n  }]);\n\n  return VerticalLinearStepper;\n}(React.Component);\n\nVerticalLinearStepper.defaultProps = {\n  item: {\n    State: 0,\n    Status: {\n      task_number: 0\n    }\n  }\n};\nexport default VerticalLinearStepper;","map":{"version":3,"sources":["/Users/kyungjoon/react_pjt/edge-cloud-ui/src/components/stepper/index.js"],"names":["React","makeStyles","Stepper","Step","StepLabel","computeService","ServiceSocket","store","actions","failFlag","deleteFlag","VerticalLinearStepper","props","receiveInterval","prgDiv","document","getElementById","scrollTop","scrollHeight","e","hashName","item","resultStream","Operator","CloudletName","_step","console","log","State","stateStream","getParentProps","ClusterInst","indexOf","auto","setState","steps","activeStep","length","clearInterval","AlertInterval","site","deletePrepare","concat","map","stat","push","receiveStatusData","result","_item","toArray","toJson","stepData","count","data","split","pop","str","JSON","parse","i","message","toLowerCase","setTimeout","alertRefresh","deleteTempFile","failRefresh","code","receiveStatusAuto","autoRefresh","useStyles","theme","root","width","button","marginTop","spacing","marginRight","actionsContainer","marginBottom","resetContainer","padding","state","classes","Status","setInterval","nextProps","nextContext","label","index","Component","defaultProps","task_number"],"mappings":"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","sourcesContent":["// https://material-ui.com/components/steppers/\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\n\nimport * as computeService from '../../services/service_compute_service';\nimport * as ServiceSocket from '../../services/service_webSocket';\nimport store from '../../store';\nimport * as actions from '../../actions';\n\nlet failFlag = false;\nlet deleteFlag = false;\n\n\n\nclass VerticalLinearStepper extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            steps:[],\n            classes:null,\n            activeStep:null,\n            _item:{Status:{}}\n        };\n\n        this.AlertInterval = null;\n        this.deletePrepare = ['DeletePrepare', 'Deleting'];\n    }\n\n    componentDidMount() {\n\n\n            this.AlertInterval = setInterval(() => {\n                this.receiveInterval()\n            }, 2000)\n\n        this.receiveInterval()\n\n    }\n\n    componentWillMount() {\n        this.setState({_item:this.props.item})\n\n    }\n    \n\n    componentWillUnmount() {\n        clearInterval(this.AlertInterval)\n        deleteFlag = false;\n    }\n    componentWillReceiveProps(nextProps, nextContext) {\n        console.log('20191119 index receive props in stepper ---- ',nextProps.item,\"== : ==\", nextProps.site, \"== : stream ?? ==\", nextProps.stateStream)\n        if(nextProps.item !== this.props.item) {\n            //console.log('20191119 receive props in stepper ---- ',nextProps.item,\"== : ==\", nextProps.site)\n            //this.setState({steps:nextProps.stateStream,activeStep:nextProps.stateStream.length - 1})\n        }\n\n    }\n\n    /*\n    props is ==========>\n    alertRefresh: ƒ ()\n    auto: \"\"\n    autoRefresh: ƒ ()\n    failRefresh: ƒ (msg)\n    item:\n        CloudletLocation: {latitude: 50.110924, longitude: 8.682127}\n        CloudletName: \"frankfurt-eu\"\n        Edit: (6) [\"Region\", \"CloudletName\", \"OperatorName\", \"CloudletLocation\", \"Ip_support\", \"Num_dynamic_ips\"]\n        Ip_support: 2\n        Num_dynamic_ips: 10\n        Operator: \"TDG\"\n        Physical_name: \"frankfurt\"\n        Platform_type: 2\n        Progress: \"\"\n        Region: \"EU\"\n        State: 5\n        Status: {}\n        __proto__: Object\n        site: \"Cloudlet\"\n        stateStream: null\n        ---------------------------\n        cloudletId = serviceBody.cloudlet.key.operator_key.name + serviceBody.cloudlet.key.name;\n    */\n\n\n    // receiveInterval = () => {\n    //\n    //     console.log('20191119 index receiveInterval info === ', this.props)\n    //\n    //\n    //\n    // }\n\n    receiveInterval = () => {\n        try{\n            const prgDiv = document.getElementById(\"prgBox\");\n            if(prgDiv){\n                prgDiv.scrollTop = prgDiv.scrollHeight;\n            }\n        } catch(e) {\n\n        }\n\n        let hashName = '';\n        let item = this.props.item;\n        let resultStream = [];\n        hashName = item.Operator + item.CloudletName;\n        let _step = []\n        console.log('20191119 getState receiveInterval info === ', this.props.item.State)\n        let stateStream = (this.props.item.State == 5) ? null : this.props.getParentProps() ;\n\n        console.log('20191119 receiveInterval === ', this.props,\":_step =\", _step,\":\")\n        if(this.props.item.State == 3 || this.props.item.State == 7) {\n            if(this.props.item.ClusterInst && this.props.item.ClusterInst.indexOf('autocluster') > -1 && this.props.auto == 'auto'){\n                //computeService.creteTempFile(this.props.item, this.props.site, this.receiveStatusAuto)\n                if(stateStream) this.setState({steps:_step,activeStep:_step.length-1})\n            } else {\n                //computeService.creteTempFile(this.props.item, this.props.site, this.receiveStatusData)\n                if(stateStream) this.setState({steps:_step,activeStep:_step.length-1})\n            }\n        } else if(this.props.item.State == 5) {\n            this.setState({steps:['Created successfully'],activeStep:1})\n            clearInterval(this.AlertInterval)\n        } else if(this.props.item.State == 10 || this.props.item.State == 12) {\n            if(this.props.site == 'Cloudlet'){\n                //computeService.creteTempFile(this.props.item, this.props.site, this.receiveStatusData)\n                if(_step.length) this.setState({steps:_step,activeStep:_step.length - 1})\n            } else{\n                this.setState({steps:this.deletePrepare.concat(_step),activeStep:_step.length })\n                clearInterval(this.AlertInterval)\n            }\n        } else  {\n            this.setState({steps:['Create error'],activeStep:1})\n        }\n        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n        console.log('20191119 getState stateStream .. ', stateStream, \":\",resultStream)\n        if(stateStream) {\n            //resultStream = this.storeData(data.data.stacksData,'createCloudlet', 'result')\n            console.log('20191119 index stateStream .. ', stateStream, \":\",resultStream)\n            if(stateStream.length > 0) {\n                console.log('20191119 index receiveInterval hashName and clId.. ', hashName)\n                stateStream.map((stat) => {\n                    console.log('20191119 index receiveInterval hashName and clId...... ', hashName , \":\", stat)\n\n                    if(stat['message']){\n                        _step.push(stat['message'])\n                    }\n\n                    //\n                    // if(!stat['message']) {\n                    //\n                    //     // refresh\n                    //     clearInterval(this.AlertInterval)\n                    //     // successfully 가 프로세스의 종료가 아닐 경우가 많음\n                    //     this.props.stopInterval('info',stat['message'])\n                    //     this.props.alertRefresh(stat['message']);\n                    //\n                    //\n                    // }\n                    //\n                    // if(stat['message'] && stat['message'].indexOf('result') > -1) {\n                    //     // refresh\n                    //     this.props.stopInterval('info',stat['message'])\n                    //     this.props.alertRefresh(stat['message']);\n                    //\n                    //     clearInterval(this.AlertInterval)\n                    // }\n                    //\n                    // if(stat['message'] && (stat['message'].indexOf('Failed') > -1 || stat['message'].indexOf('failed') > -1)) {\n                    //\n                    //     this.props.stopInterval('error',stat['message'])\n                    //     this.props.failRefresh(stat['message']);\n                    //     clearInterval(this.AlertInterval)\n                    // }\n\n                })\n            }\n        }\n\n\n    }\n\n    receiveStatusData = (result, _item) => {\n        console.log(\"receiveStatusAuto222\",result,\":::\",_item)\n        let toArray = null;\n        let toJson = null;\n        let stepData = [];\n        let count = 0;\n        toArray = result.data.split('\\n')\n        toArray.pop();\n        toJson = toArray.map((str)=>(JSON.parse(str)))\n        toJson.map((item,i) => {\n            if(item.data) {\n                stepData.push(item.data.message) //Created ClusterInst successfully\n                //console.log(\"successfullyzxxx222\",item.data.message,\":::\",item.data.message.toLowerCase().indexOf('created successfully'))\n                if(item.data.message.toLowerCase().indexOf('created') > -1 && item.data.message.toLowerCase().indexOf('successfully') > -1 && !deleteFlag){\n                    deleteFlag = true;\n                    console.log(\"Created successfullyCreated successfully\")\n                    count++;\n                    if(_item.ClusterInst && _item.ClusterInst.indexOf('autocluster') > -1 && count < 2){\n                        deleteFlag = false;\n                        return;\n                    };\n                    setTimeout(() => {\n                        this.props.alertRefresh();\n                        computeService.deleteTempFile(this.props.item, this.props.site)\n                    }, 2000);\n                } else if(item.data.message.toLowerCase().indexOf('deleted cloudlet successfully') > -1){\n                    deleteFlag = true;\n                    console.log(\"Delete successfullyCreated successfully\")\n                    setTimeout(() => {\n                        this.props.failRefresh('Deleted cloudlet successfully');\n                        computeService.deleteTempFile(this.props.item, this.props.site)\n                    }, 2000);\n                } else if(item.data.message.toLowerCase().indexOf('completed') > -1 && item.data.message.toLowerCase().indexOf('updated') > -1 && !deleteFlag){\n                    deleteFlag = true;\n                    console.log(\"Updated AppInst\")\n                    setTimeout(() => {\n                        this.props.alertRefresh();\n                        computeService.deleteTempFile(this.props.item, this.props.site)\n                    }, 2000);\n                }\n            } else if(item.result && item.result.code == 400 && !failFlag){\n                console.log(\"failRefreshfailRefreshfailRefresh\")\n                failFlag = true;\n                stepData.push(item.result.message)\n                setTimeout(() => {\n                    this.props.failRefresh(item.result.message);\n                    computeService.deleteTempFile(this.props.item, this.props.site)\n                }, 3000);\n            }\n        })\n        console.log(\"toArraytoArray\",stepData)\n        this.setState({steps:stepData, activeStep:stepData.length-1})\n\n    }\n\n    receiveStatusAuto = (result, _item) => {\n        let toArray = null;\n        let toJson = null;\n        let count = 0;\n        let stepData = [];\n        toArray = result.data.split('\\n')\n        toArray.pop();\n        toJson = toArray.map((str)=>(JSON.parse(str)))\n        toJson.map((item,i) => {\n            stepData.push(item.data.message)\n            if(item.data) {\n                if(item.data.message.toLowerCase().indexOf('created') > -1 && item.data.message.toLowerCase().indexOf('successfully') > -1){\n                    console.log(\"Created successfullyCreated successfully\")\n                    count++;\n                    setTimeout(() => {\n                        if(count == 1){\n                            this.props.autoRefresh();\n                        }\n                    }, 1000);\n                    \n                }\n            }\n        })\n        this.setState({steps:stepData, activeStep:stepData.length-1})\n    }\n    \n\n        \n    // }\n    // percent = (item) => {\n    //     if(this.props.item.State == 10 || this.props.item.State == 12) {\n    //         if(item.State == 12) return 50\n    //         else if(item.State == 10) return 80\n    //         else return 100\n    //     } else {\n    //         if(this.props.site == 'ClusterInst') {\n    //             if(Object.keys(item.Status).length === 0 && item.State == 3) return 10\n    //             else if(item.Status.task_number == 1 && !item.Status.step_name) return 20\n    //             else if(item.Status.task_number == 1 && item.Status.step_name) return 30\n    //             else if(item.Status.task_number == 2 && !item.Status.step_name) return 50\n    //             else if(item.Status.task_number == 2 && item.Status.step_name) return 70\n    //             else if(item.Status.task_number == 3) return 90\n    //             else if(Object.keys(item.Status).length === 0 && item.State == 5) return 100\n    //         } else if(this.props.site == 'appinst') {\n    //             if(Object.keys(item.Status).length === 0 && item.State == 3) return 10\n    //             else if(item.Status.task_number == 1) return 30\n    //             else if(item.Status.task_number == 2) return 50\n    //             else if(item.Status.task_number == 3) return 80\n    //             else if(Object.keys(item.Status).length === 0 && item.State == 5) return 100\n    //         }\n            \n    //     }\n    // }\n\n \n\n    useStyles = makeStyles(theme => ({\n        root: {\n            width: '90%',\n        },\n        button: {\n            marginTop: theme.spacing(1),\n            marginRight: theme.spacing(1),\n        },\n        actionsContainer: {\n            marginBottom: theme.spacing(2),\n        },\n        resetContainer: {\n            padding: theme.spacing(3),\n        },\n    }));\n\n    render() {\n        const { steps,activeStep } = this.state;\n        let classes = this.useStyles\n        return (\n            <div>\n                {/* <div>\n                    <Progress percent={this.percent(this.state._item)} progress />\n                </div> */}\n                <Stepper activeStep={activeStep} orientation=\"vertical\">\n                    {steps.map((label, index) => (\n                        <Step key={label}>\n                            <StepLabel>{label}</StepLabel>\n                        </Step>\n                    ))}\n                </Stepper>\n            </div>\n        );\n    }\n    \n    \n}\nVerticalLinearStepper.defaultProps = {\n    item:{State:0, Status:{task_number:0}}\n}\n\n\n\n\nexport default VerticalLinearStepper;\n"]},"metadata":{},"sourceType":"module"}