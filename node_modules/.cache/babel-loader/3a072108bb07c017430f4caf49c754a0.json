{"ast":null,"code":"import { range } from \"d3-array\";\nimport { geoStream, geoProjectionMutator as projectionMutator } from \"d3-geo\";\nimport { collignonRaw } from \"./collignon\";\nimport { cylindricalEqualAreaRaw } from \"./cylindricalEqualArea\";\nimport { abs, floor, max, min, pi, radians, sqrtPi, tau } from \"./math\";\nvar healpixParallel = 41 + 48 / 36 + 37 / 3600,\n    // for K=3; TODO automate\nhealpixLambert = cylindricalEqualAreaRaw(0);\nexport function healpixRaw(H) {\n  var phi0 = healpixParallel * radians,\n      dx = collignonRaw(pi, phi0)[0] - collignonRaw(-pi, phi0)[0],\n      y0 = healpixLambert(0, phi0)[1],\n      y1 = collignonRaw(0, phi0)[1],\n      dy1 = sqrtPi - y1,\n      k = tau / H,\n      w = 4 / tau,\n      h = y0 + dy1 * dy1 * 4 / tau;\n\n  function forward(lambda, phi) {\n    var point,\n        phi2 = abs(phi);\n\n    if (phi2 > phi0) {\n      var i = min(H - 1, max(0, floor((lambda + pi) / k)));\n      lambda += pi * (H - 1) / H - i * k;\n      point = collignonRaw(lambda, phi2);\n      point[0] = point[0] * tau / dx - tau * (H - 1) / (2 * H) + i * tau / H;\n      point[1] = y0 + (point[1] - y1) * 4 * dy1 / tau;\n      if (phi < 0) point[1] = -point[1];\n    } else {\n      point = healpixLambert(lambda, phi);\n    }\n\n    point[0] *= w, point[1] /= h;\n    return point;\n  }\n\n  forward.invert = function (x, y) {\n    x /= w, y *= h;\n    var y2 = abs(y);\n\n    if (y2 > y0) {\n      var i = min(H - 1, max(0, floor((x + pi) / k)));\n      x = (x + pi * (H - 1) / H - i * k) * dx / tau;\n      var point = collignonRaw.invert(x, 0.25 * (y2 - y0) * tau / dy1 + y1);\n      point[0] -= pi * (H - 1) / H - i * k;\n      if (y < 0) point[1] = -point[1];\n      return point;\n    }\n\n    return healpixLambert.invert(x, y);\n  };\n\n  return forward;\n}\n\nfunction sphere(step) {\n  return {\n    type: \"Polygon\",\n    coordinates: [range(-180, 180 + step / 2, step).map(function (x, i) {\n      return [x, i & 1 ? 90 - 1e-6 : healpixParallel];\n    }).concat(range(180, -180 - step / 2, -step).map(function (x, i) {\n      return [x, i & 1 ? -90 + 1e-6 : -healpixParallel];\n    }))]\n  };\n}\n\nexport default function () {\n  var H = 4,\n      m = projectionMutator(healpixRaw),\n      p = m(H),\n      stream_ = p.stream;\n\n  p.lobes = function (_) {\n    return arguments.length ? m(H = +_) : H;\n  };\n\n  p.stream = function (stream) {\n    var rotate = p.rotate(),\n        rotateStream = stream_(stream),\n        sphereStream = (p.rotate([0, 0]), stream_(stream));\n    p.rotate(rotate);\n\n    rotateStream.sphere = function () {\n      geoStream(sphere(180 / H), sphereStream);\n    };\n\n    return rotateStream;\n  };\n\n  return p.scale(239.75);\n}","map":{"version":3,"sources":["/Users/kyungjoon/react_pjt/edge-cloud-ui/node_modules/react-simple-maps/node_modules/d3-geo-projection/src/healpix.js"],"names":["range","geoStream","geoProjectionMutator","projectionMutator","collignonRaw","cylindricalEqualAreaRaw","abs","floor","max","min","pi","radians","sqrtPi","tau","healpixParallel","healpixLambert","healpixRaw","H","phi0","dx","y0","y1","dy1","k","w","h","forward","lambda","phi","point","phi2","i","invert","x","y","y2","sphere","step","type","coordinates","map","concat","m","p","stream_","stream","lobes","_","arguments","length","rotate","rotateStream","sphereStream","scale"],"mappings":"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","sourcesContent":["import {range} from \"d3-array\";\nimport {geoStream, geoProjectionMutator as projectionMutator} from \"d3-geo\";\nimport {collignonRaw} from \"./collignon\";\nimport {cylindricalEqualAreaRaw} from \"./cylindricalEqualArea\";\nimport {abs, floor, max, min, pi, radians, sqrtPi, tau} from \"./math\";\n\nvar healpixParallel = 41 + 48 / 36 + 37 / 3600, // for K=3; TODO automate\n    healpixLambert = cylindricalEqualAreaRaw(0);\n\nexport function healpixRaw(H) {\n  var phi0 = healpixParallel * radians,\n      dx = collignonRaw(pi, phi0)[0] - collignonRaw(-pi, phi0)[0],\n      y0 = healpixLambert(0, phi0)[1],\n      y1 = collignonRaw(0, phi0)[1],\n      dy1 = sqrtPi - y1,\n      k = tau / H,\n      w = 4 / tau,\n      h = y0 + (dy1 * dy1 * 4) / tau;\n\n  function forward(lambda, phi) {\n    var point,\n        phi2 = abs(phi);\n    if (phi2 > phi0) {\n      var i = min(H - 1, max(0, floor((lambda + pi) / k)));\n      lambda += pi * (H - 1) / H - i * k;\n      point = collignonRaw(lambda, phi2);\n      point[0] = point[0] * tau / dx - tau * (H - 1) / (2 * H) + i * tau / H;\n      point[1] = y0 + (point[1] - y1) * 4 * dy1 / tau;\n      if (phi < 0) point[1] = -point[1];\n    } else {\n      point = healpixLambert(lambda, phi);\n    }\n    point[0] *= w, point[1] /= h;\n    return point;\n  }\n\n  forward.invert = function(x, y) {\n    x /= w, y *= h;\n    var y2 = abs(y);\n    if (y2 > y0) {\n      var i = min(H - 1, max(0, floor((x + pi) / k)));\n      x = (x + pi * (H - 1) / H - i * k) * dx / tau;\n      var point = collignonRaw.invert(x, 0.25 * (y2 - y0) * tau / dy1 + y1);\n      point[0] -= pi * (H - 1) / H - i * k;\n      if (y < 0) point[1] = -point[1];\n      return point;\n    }\n    return healpixLambert.invert(x, y);\n  };\n\n  return forward;\n}\n\nfunction sphere(step) {\n  return {\n    type: \"Polygon\",\n    coordinates: [\n      range(-180, 180 + step / 2, step).map(function(x, i) { return [x, i & 1 ? 90 - 1e-6 : healpixParallel]; })\n      .concat(range(180, -180 - step / 2, -step).map(function(x, i) { return [x, i & 1 ? -90 + 1e-6 : -healpixParallel]; }))\n    ]\n  };\n}\n\nexport default function() {\n  var H = 4,\n      m = projectionMutator(healpixRaw),\n      p = m(H),\n      stream_ = p.stream;\n\n  p.lobes = function(_) {\n    return arguments.length ? m(H = +_) : H;\n  };\n\n  p.stream = function(stream) {\n    var rotate = p.rotate(),\n        rotateStream = stream_(stream),\n        sphereStream = (p.rotate([0, 0]), stream_(stream));\n    p.rotate(rotate);\n    rotateStream.sphere = function() { geoStream(sphere(180 / H), sphereStream); };\n    return rotateStream;\n  };\n\n  return p\n      .scale(239.75);\n}\n"]},"metadata":{},"sourceType":"module"}