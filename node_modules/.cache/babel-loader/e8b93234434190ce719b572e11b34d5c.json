{"ast":null,"code":"import _classCallCheck from \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/src/sites/siteFour_page_appinst.js\";\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport sizeMe from 'react-sizeme';\nimport Alert from \"react-s-alert\"; //redux\n\nimport { connect } from 'react-redux';\nimport * as actions from '../actions';\nimport * as services from '../services/service_compute_service';\nimport './siteThree.css';\nimport MapWithListView from \"../container/mapWithListView\";\nimport PageDetailViewer from '../container/pageDetailViewer';\nimport DeveloperListView from \"../container/developerListView\";\nimport * as reducer from '../utils';\nvar _self = null;\nvar rgn = [];\n\nvar SiteFourPageAppInst =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SiteFourPageAppInst, _React$Component);\n\n  function SiteFourPageAppInst(props) {\n    var _this;\n\n    _classCallCheck(this, SiteFourPageAppInst);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SiteFourPageAppInst).call(this, props));\n\n    _this.handleItemClick = function (e, _ref) {\n      var name = _ref.name;\n      return _this.setState({\n        activeItem: name\n      });\n    };\n\n    _this.receiveResult = function (result) {\n      // @inki if data has expired token\n      if (result.error && result.error.indexOf('Expired') > -1) {\n        _self.props.handleAlertInfo('error', result.error);\n\n        setTimeout(function () {\n          return _self.gotoUrl('/logout');\n        }, 4000);\n\n        _self.props.handleLoadingSpinner(false);\n\n        return;\n      }\n\n      var regionGroup = !result.error ? reducer.groupBy(result, 'Region') : {};\n\n      if (Object.keys(regionGroup)[0]) {\n        _self._AppInstDummy = _self._AppInstDummy.concat(result);\n      }\n\n      _self.loadCount++;\n\n      if (rgn.length == _self.loadCount) {\n        _self.countJoin();\n      }\n\n      _self.props.handleLoadingSpinner(false); // console.log(\"appinstresult\",result)\n      // let join = null;\n      // if(!result.error && result[0]['Edit']) {\n      //     join = this.state.devData.concat(result);\n      // } else {\n      //     join = this.state.devData;\n      // }\n      // this.loadCount ++;\n      // this.setState({devData:join})\n      // this.props.handleLoadingSpinner(false);\n      // console.log(\"rgn.lengthrgn.length\",rgn.length,\":::\",this.loadCount)\n      // if(rgn.length == this.loadCount-1){\n      //     return\n      // }\n\n    };\n\n    _this.receiveResultApp = function (result) {\n      var diff = [];\n      _this._diffRev = [];\n\n      if (!result.error) {\n        result.map(function (item) {\n          _this.state.devData.map(function (_data) {\n            if (item.Region == _data.Region && item.AppName == _data.AppName && item.OrganizationName == _data.OrganizationName && item.Revision != _data.Revision) {\n              _this._diffRev.push(_data);\n            }\n          });\n        });\n\n        _this.forceUpdate();\n      }\n    };\n\n    _this.getDataDeveloper = function (region, regionArr) {\n      _this.props.handleLoadingSpinner(true);\n\n      var store = localStorage.PROJECT_INIT ? JSON.parse(localStorage.PROJECT_INIT) : null;\n      var serviceBody = {};\n      _this.loadCount = 0;\n\n      _this.setState({\n        devData: []\n      });\n\n      _this._AppInstDummy = [];\n\n      if (region !== 'All') {\n        rgn = [region];\n      } else {\n        rgn = regionArr ? regionArr : _this.props.regionInfo.region;\n      }\n\n      if (localStorage.selectRole == 'AdminManager') {\n        rgn.map(function (item) {\n          // All show appInst\n          services.getMCService('ShowAppInst', {\n            token: store ? store.userToken : 'null',\n            region: item\n          }, _self.receiveResult);\n        });\n      } else {\n        rgn.map(function (item) {\n          serviceBody = {\n            \"token\": store.userToken,\n            \"params\": {\n              \"region\": item,\n              \"appinst\": {\n                \"key\": {\n                  \"app_key\": {\n                    \"developer_key\": {\n                      \"name\": localStorage.selectOrg\n                    }\n                  }\n                }\n              }\n            }\n          }; // org별 show appInst\n\n          services.getMCService('ShowAppInsts', serviceBody, _self.receiveResult);\n        });\n      }\n    };\n\n    _this.getDataDeveloperSub = function (region) {\n      console.log(\"getDataDeveloperSubsss\", region);\n      _this._diffRev = [];\n\n      var _region = region ? region : 'All';\n\n      _this.getDataDeveloper(_region);\n    };\n\n    _this.getUpdateData = function (region) {\n      var store = localStorage.PROJECT_INIT ? JSON.parse(localStorage.PROJECT_INIT) : null;\n      var serviceBody = {};\n\n      if (region !== 'All') {\n        rgn = [region];\n      } else {\n        rgn = _this.props.regionInfo.region;\n      }\n\n      if (localStorage.selectRole == 'AdminManager') {\n        rgn.map(function (item) {\n          // All show app\n          services.getMCService('ShowApps', {\n            token: store ? store.userToken : 'null',\n            region: item\n          }, _self.receiveResultApp);\n        });\n      } else {\n        rgn.map(function (item) {\n          serviceBody = {\n            \"token\": store ? store.userToken : 'null',\n            \"params\": {\n              \"region\": item,\n              \"app\": {\n                \"key\": {\n                  \"developer_key\": {\n                    \"name\": localStorage.selectOrg\n                  }\n                }\n              }\n            }\n          }; // org별 show app\n\n          services.getMCService('ShowApp', serviceBody, _self.receiveResultApp);\n        });\n      }\n    };\n\n    _self = _assertThisInitialized(_this);\n    _this.state = {\n      shouldShowBox: true,\n      shouldShowCircle: false,\n      bodyHeight: 0,\n      devData: [],\n      viewMode: 'listView',\n      detailData: null,\n      hiddenKeys: ['Error', 'URI', 'Mapped_port', 'Runtime', 'Created', 'Liveness', 'Flavor', 'Status', 'Revision'],\n      AppRevision: [],\n      regionToggle: false,\n      dataSort: false\n    };\n    _this.headerH = 70;\n    _this.hgap = 0;\n    _this.loadCount = 0;\n    _this.headerLayout = [2, 2, 2, 1, 1, 2, 2, 2, 1, 4];\n    _this._devData = [];\n    _this._AppInstDummy = [];\n    _this._diffRev = [];\n    return _this;\n  }\n\n  _createClass(SiteFourPageAppInst, [{\n    key: \"gotoUrl\",\n    value: function gotoUrl(site, subPath) {\n      var mainPath = site;\n\n      _self.props.history.push({\n        pathname: site,\n        search: subPath\n      });\n\n      _self.props.history.location.search = subPath;\n\n      _self.props.handleChangeSite({\n        mainPath: mainPath,\n        subPath: subPath\n      });\n    } //go to\n\n  }, {\n    key: \"gotoPreview\",\n    value: function gotoPreview(site) {\n      //브라우져 입력창에 주소 기록\n      var mainPath = site;\n      var subPath = 'pg=0';\n\n      _self.props.history.push({\n        pathname: mainPath,\n        search: subPath,\n        state: {\n          some: 'state'\n        }\n      });\n\n      _self.props.history.location.search = subPath;\n\n      _self.props.handleChangeSite({\n        mainPath: mainPath,\n        subPath: subPath\n      });\n    }\n  }, {\n    key: \"onHandleRegistry\",\n    value: function onHandleRegistry() {\n      this.props.handleInjectDeveloper('userInfo');\n    }\n  }, {\n    key: \"setHiddenKey\",\n    value: function setHiddenKey(key) {\n      var copyHiddenKeys = Object.assign([], this.state.hiddenKeys);\n      var newHiddenKeys = [];\n\n      if (key.hidden === true) {\n        newHiddenKeys = copyHiddenKeys.concat(key.name);\n      } else {\n        //remove key from hiddenKeys\n        newHiddenKeys = reducer.filterDefine(this.state.hiddenKeys, [key.name]);\n      }\n\n      this.setState({\n        hiddenKeys: newHiddenKeys\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.setState({\n        bodyHeight: window.innerHeight - this.headerH\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // let store = localStorage.PROJECT_INIT ? JSON.parse(localStorage.PROJECT_INIT) : null\n      // if(store.userToken) {\n      //     this.getDataDeveloper(this.props.changeRegion);\n      //     // this.getUpdateData(this.props.changeRegion);\n      // }\n      this._devData = [];\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._AppInstDummy = [];\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var _this2 = this;\n\n      this.setState({\n        bodyHeight: window.innerHeight - this.headerH\n      });\n\n      if (nextProps.computeRefresh.compute) {\n        this.getDataDeveloper(nextProps.changeRegion);\n        this.props.handleComputeRefresh(false);\n        this.setState({\n          dataSort: true\n        });\n      }\n\n      if (this.props.changeRegion !== nextProps.changeRegion) {\n        this.getDataDeveloper(nextProps.changeRegion);\n      }\n\n      if (nextProps.regionInfo.region.length && !this.state.regionToggle) {\n        _self.setState({\n          regionToggle: true\n        });\n\n        this.getDataDeveloper(nextProps.changeRegion, nextProps.regionInfo.region);\n      }\n\n      if (nextProps.viewMode) {\n        if (nextProps.viewMode === 'listView') {\n          //alert('viewmode..'+nextProps.viewMode+':'+ this.state.devData)\n          //this.getDataDeveloper(this.props.changeRegion)\n          this.setState({\n            viewMode: nextProps.viewMode\n          });\n        } else {\n          this.setState({\n            detailData: nextProps.detailData\n          });\n          this.forceUpdate();\n          setTimeout(function () {\n            return _this2.setState({\n              viewMode: nextProps.viewMode\n            });\n          }, 600);\n        }\n      } //make hidden key\n\n\n      var tbHeader = nextProps.headerFilter;\n\n      if (tbHeader) {\n        this.setHiddenKey(tbHeader);\n      }\n\n      setTimeout(function () {\n        return _this2.forceUpdate();\n      }, 1000);\n    }\n  }, {\n    key: \"countJoin\",\n    value: function countJoin() {\n      var AppInst = this._AppInstDummy;\n\n      _self.setState({\n        devData: AppInst,\n        dataSort: false\n      });\n\n      this.props.handleLoadingSpinner(false);\n      this.getUpdateData(this.props.changeRegion);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          shouldShowBox = _this$state.shouldShowBox,\n          shouldShowCircle = _this$state.shouldShowCircle;\n      var _this$state2 = this.state,\n          activeItem = _this$state2.activeItem,\n          viewMode = _this$state2.viewMode,\n          devData = _this$state2.devData,\n          detailData = _this$state2.detailData;\n      return viewMode === 'listView' ? React.createElement(MapWithListView, {\n        devData: devData,\n        headerLayout: this.headerLayout,\n        hiddenKeys: this.state.hiddenKeys,\n        siteId: \"appinst\",\n        dataRefresh: this.getDataDeveloperSub,\n        diffRev: this._diffRev,\n        dataSort: this.state.dataSort,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }) : React.createElement(PageDetailViewer, {\n        data: detailData,\n        page: \"appInst\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return SiteFourPageAppInst;\n}(React.Component);\n\n;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  var stateChange = false;\n\n  if (state.receiveDataReduce.params && state.receiveDataReduce.params.state === 'refresh') {\n    stateChange = true;\n  }\n\n  var viewMode = null;\n  var detailData = null;\n\n  if (state.changeViewMode.mode && state.changeViewMode.mode.viewMode) {\n    viewMode = state.changeViewMode.mode.viewMode;\n    detailData = state.changeViewMode.mode.data;\n  }\n\n  var regionInfo = state.regionInfo ? state.regionInfo : null;\n  return {\n    stateChange: stateChange,\n    computeRefresh: state.computeRefresh ? state.computeRefresh : null,\n    changeRegion: state.changeRegion.region ? state.changeRegion.region : null,\n    selectOrg: state.selectOrg.org ? state.selectOrg.org : null,\n    userRole: state.showUserRole ? state.showUserRole.role : null,\n    viewMode: viewMode,\n    detailData: detailData,\n    headerFilter: state.tableHeader.filter ? state.tableHeader.filter : null,\n    regionInfo: regionInfo\n  };\n};\n\nvar mapDispatchProps = function mapDispatchProps(dispatch) {\n  return {\n    handleChangeSite: function handleChangeSite(data) {\n      dispatch(actions.changeSite(data));\n    },\n    handleInjectData: function handleInjectData(data) {\n      dispatch(actions.injectData(data));\n    },\n    handleInjectDeveloper: function handleInjectDeveloper(data) {\n      dispatch(actions.registDeveloper(data));\n    },\n    handleComputeRefresh: function handleComputeRefresh(data) {\n      dispatch(actions.computeRefresh(data));\n    },\n    handleLoadingSpinner: function handleLoadingSpinner(data) {\n      dispatch(actions.loadingSpinner(data));\n    },\n    handleAlertInfo: function handleAlertInfo(mode, msg) {\n      dispatch(actions.alertInfo(mode, msg));\n    }\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchProps)(sizeMe({\n  monitorHeight: true\n})(SiteFourPageAppInst)));","map":{"version":3,"sources":["/Users/kyungjoon/react_pjt/edge-cloud-ui_current-working/src/sites/siteFour_page_appinst.js"],"names":["React","withRouter","sizeMe","Alert","connect","actions","services","MapWithListView","PageDetailViewer","DeveloperListView","reducer","_self","rgn","SiteFourPageAppInst","props","handleItemClick","e","name","setState","activeItem","receiveResult","result","error","indexOf","handleAlertInfo","setTimeout","gotoUrl","handleLoadingSpinner","regionGroup","groupBy","Object","keys","_AppInstDummy","concat","loadCount","length","countJoin","receiveResultApp","diff","_diffRev","map","item","state","devData","_data","Region","AppName","OrganizationName","Revision","push","forceUpdate","getDataDeveloper","region","regionArr","store","localStorage","PROJECT_INIT","JSON","parse","serviceBody","regionInfo","selectRole","getMCService","token","userToken","selectOrg","getDataDeveloperSub","console","log","_region","getUpdateData","shouldShowBox","shouldShowCircle","bodyHeight","viewMode","detailData","hiddenKeys","AppRevision","regionToggle","dataSort","headerH","hgap","headerLayout","_devData","site","subPath","mainPath","history","pathname","search","location","handleChangeSite","some","handleInjectDeveloper","key","copyHiddenKeys","assign","newHiddenKeys","hidden","filterDefine","window","innerHeight","nextProps","computeRefresh","compute","changeRegion","handleComputeRefresh","tbHeader","headerFilter","setHiddenKey","AppInst","Component","mapStateToProps","stateChange","receiveDataReduce","params","changeViewMode","mode","data","org","userRole","showUserRole","role","tableHeader","filter","mapDispatchProps","dispatch","changeSite","handleInjectData","injectData","registDeveloper","loadingSpinner","msg","alertInfo","monitorHeight"],"mappings":"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","sourcesContent":["import React from 'react';\n\n\nimport { withRouter } from 'react-router-dom';\nimport sizeMe from 'react-sizeme';\nimport Alert from \"react-s-alert\";\n//redux\nimport { connect } from 'react-redux';\nimport * as actions from '../actions';\nimport * as services from '../services/service_compute_service';\nimport './siteThree.css';\nimport MapWithListView from \"../container/mapWithListView\";\nimport PageDetailViewer from '../container/pageDetailViewer';\nimport DeveloperListView from \"../container/developerListView\";\nimport * as reducer from '../utils'\n\nlet _self = null;\nlet rgn = [];\nclass SiteFourPageAppInst extends React.Component {\n    constructor(props) {\n        super(props);\n        _self = this;\n        this.state = {\n            shouldShowBox: true,\n            shouldShowCircle: false,\n            bodyHeight:0,\n            devData:[],\n            viewMode:'listView',\n            detailData:null,\n            hiddenKeys:['Error','URI', 'Mapped_port', 'Runtime', 'Created', 'Liveness','Flavor','Status','Revision'],\n            AppRevision:[],\n            regionToggle:false,\n            dataSort:false\n        };\n        this.headerH = 70;\n        this.hgap = 0;\n        this.loadCount = 0;\n\n        this.headerLayout = [2,2,2,1,1,2,2,2,1,4];\n        this._devData = [];\n        this._AppInstDummy = [];\n        this._diffRev = []\n    }\n    gotoUrl(site, subPath) {\n        let mainPath = site;\n        _self.props.history.push({\n            pathname: site,\n            search: subPath\n        });\n        _self.props.history.location.search = subPath;\n        _self.props.handleChangeSite({mainPath:mainPath, subPath: subPath})\n\n    }\n    //go to\n    gotoPreview(site) {\n        //브라우져 입력창에 주소 기록\n        let mainPath = site;\n        let subPath = 'pg=0';\n        _self.props.history.push({\n            pathname: mainPath,\n            search: subPath,\n            state: { some: 'state' }\n        });\n        _self.props.history.location.search = subPath;\n        _self.props.handleChangeSite({mainPath:mainPath, subPath: subPath})\n\n    }\n    handleItemClick = (e, { name }) => this.setState({ activeItem: name })\n\n    onHandleRegistry() {\n        this.props.handleInjectDeveloper('userInfo');\n    }\n    setHiddenKey(key) {\n        let copyHiddenKeys = Object.assign([],this.state.hiddenKeys)\n        let newHiddenKeys = [];\n        if(key.hidden === true) {\n            newHiddenKeys = copyHiddenKeys.concat(key.name)\n\n        } else {\n            //remove key from hiddenKeys\n            newHiddenKeys = reducer.filterDefine(this.state.hiddenKeys, [key.name])\n        }\n\n        this.setState({hiddenKeys:newHiddenKeys})\n\n    }\n\n    componentWillMount() {\n        this.setState({bodyHeight : (window.innerHeight - this.headerH)})\n    }\n    componentDidMount() {\n        // let store = localStorage.PROJECT_INIT ? JSON.parse(localStorage.PROJECT_INIT) : null\n        // if(store.userToken) {\n        //     this.getDataDeveloper(this.props.changeRegion);\n        //     // this.getUpdateData(this.props.changeRegion);\n        // }\n        this._devData = [];\n    }\n    componentWillUnmount() {\n        this._AppInstDummy = []\n    }\n\n\n    componentWillReceiveProps(nextProps) {\n        this.setState({bodyHeight : (window.innerHeight - this.headerH)})\n\n        if(nextProps.computeRefresh.compute) {\n            this.getDataDeveloper(nextProps.changeRegion);\n            this.props.handleComputeRefresh(false);\n            this.setState({dataSort:true});\n        }\n        if(this.props.changeRegion !== nextProps.changeRegion){\n            this.getDataDeveloper(nextProps.changeRegion);\n        }\n        if(nextProps.regionInfo.region.length && !this.state.regionToggle) {\n            _self.setState({regionToggle:true})\n            this.getDataDeveloper(nextProps.changeRegion,nextProps.regionInfo.region);\n        }\n        if(nextProps.viewMode) {\n            if(nextProps.viewMode === 'listView') {\n\n                //alert('viewmode..'+nextProps.viewMode+':'+ this.state.devData)\n                //this.getDataDeveloper(this.props.changeRegion)\n                this.setState({viewMode:nextProps.viewMode})\n            } else {\n                this.setState({detailData:nextProps.detailData})\n                this.forceUpdate()\n                setTimeout(() => this.setState({viewMode:nextProps.viewMode}), 600)\n            }\n\n        }\n\n        //make hidden key\n        let tbHeader = nextProps.headerFilter;\n        if(tbHeader) {\n            this.setHiddenKey(tbHeader)\n        }\n        setTimeout(() => this.forceUpdate(), 1000)\n\n    }\n    receiveResult = (result) => {\n        // @inki if data has expired token\n        if(result.error && result.error.indexOf('Expired') > -1) {\n            _self.props.handleAlertInfo('error', result.error);\n            setTimeout(() => _self.gotoUrl('/logout'), 4000);\n            _self.props.handleLoadingSpinner(false);\n            return;\n        }\n\n        let regionGroup = (!result.error) ? reducer.groupBy(result, 'Region'):{};\n        if(Object.keys(regionGroup)[0]) {\n            _self._AppInstDummy = _self._AppInstDummy.concat(result)\n        }\n        _self.loadCount ++;\n        if(rgn.length == _self.loadCount){\n            _self.countJoin()\n        }\n        _self.props.handleLoadingSpinner(false);\n        // console.log(\"appinstresult\",result)\n        // let join = null;\n        // if(!result.error && result[0]['Edit']) {\n        //     join = this.state.devData.concat(result);\n        // } else {\n        //     join = this.state.devData;\n        // }\n        // this.loadCount ++;\n        // this.setState({devData:join})\n        // this.props.handleLoadingSpinner(false);\n        // console.log(\"rgn.lengthrgn.length\",rgn.length,\":::\",this.loadCount)\n        // if(rgn.length == this.loadCount-1){\n        //     return\n        // }\n    }\n    countJoin() {\n        let AppInst = this._AppInstDummy;\n        _self.setState({devData:AppInst,dataSort:false})\n        this.props.handleLoadingSpinner(false);\n        this.getUpdateData(this.props.changeRegion);\n    }\n    receiveResultApp = (result) => {\n        let diff = []\n        this._diffRev = [];\n        if(!result.error){\n            result.map((item) => {\n                this.state.devData.map((_data) => {\n                    if(item.Region == _data.Region && item.AppName == _data.AppName && item.OrganizationName == _data.OrganizationName && item.Revision != _data.Revision){\n                        this._diffRev.push(_data)\n                    }\n                })\n            })\n            this.forceUpdate();\n        }\n        \n    }\n\n    getDataDeveloper = (region,regionArr) => {\n        this.props.handleLoadingSpinner(true);\n        let store = localStorage.PROJECT_INIT ? JSON.parse(localStorage.PROJECT_INIT) : null\n        let serviceBody = {}\n        this.loadCount = 0;\n        this.setState({devData:[]})\n        this._AppInstDummy = []\n        if(region !== 'All'){\n            rgn = [region]\n        } else {\n            rgn = (regionArr)?regionArr:this.props.regionInfo.region;\n        }\n \n        if(localStorage.selectRole == 'AdminManager') {\n            rgn.map((item) => {\n                // All show appInst\n                services.getMCService('ShowAppInst',{token:store ? store.userToken : 'null', region:item}, _self.receiveResult)\n            })\n        } else {\n            rgn.map((item) => {\n                serviceBody = {\n                    \"token\":store.userToken,\n                    \"params\": {\n                        \"region\":item,\n                        \"appinst\":{\n                            \"key\":{\n                                \"app_key\": {\n                                    \"developer_key\":{\"name\":localStorage.selectOrg},\n                                }\n                            }\n                        }\n                    }\n                }\n                // org별 show appInst\n                services.getMCService('ShowAppInsts',serviceBody, _self.receiveResult)\n            })\n        }\n    }\n    getDataDeveloperSub = (region) => {\n        console.log(\"getDataDeveloperSubsss\",region)\n        this._diffRev = []\n        let _region = (region)?region:'All';\n        this.getDataDeveloper(_region);\n    }\n    getUpdateData = (region) => {\n        let store = localStorage.PROJECT_INIT ? JSON.parse(localStorage.PROJECT_INIT) : null\n        let serviceBody = {}\n        if(region !== 'All'){\n            rgn = [region]\n        } else {\n            rgn = this.props.regionInfo.region;\n        }\n\n        if(localStorage.selectRole == 'AdminManager') {\n            rgn.map((item) => {\n                // All show app\n                services.getMCService('ShowApps',{token:store ? store.userToken : 'null', region:item}, _self.receiveResultApp)\n            })\n        } else {\n            rgn.map((item) => {\n                serviceBody = {\n                    \"token\":store ? store.userToken : 'null',\n                    \"params\": {\n                        \"region\":item,\n                        \"app\":{\n                            \"key\":{\n                                \"developer_key\":{\"name\":localStorage.selectOrg},\n                            }\n                        }\n                    }\n                }\n                // org별 show app\n                services.getMCService('ShowApp',serviceBody, _self.receiveResultApp)\n            })\n        }\n    }\n    render() {\n        const {shouldShowBox, shouldShowCircle} = this.state;\n        const { activeItem, viewMode, devData, detailData } = this.state;\n        return (\n            (viewMode === 'listView')?\n            <MapWithListView devData={devData} headerLayout={this.headerLayout} hiddenKeys={this.state.hiddenKeys} siteId='appinst' dataRefresh={this.getDataDeveloperSub} diffRev={this._diffRev} dataSort={this.state.dataSort}></MapWithListView>\n            :\n            <PageDetailViewer data={detailData} page='appInst'/>\n        );\n    }\n\n};\n\nconst mapStateToProps = (state) => {\n\n    let stateChange = false;\n    if(state.receiveDataReduce.params && state.receiveDataReduce.params.state === 'refresh'){\n        stateChange = true;\n    }\n    let viewMode = null;\n    let detailData = null;\n    if(state.changeViewMode.mode && state.changeViewMode.mode.viewMode) {\n        viewMode = state.changeViewMode.mode.viewMode;\n        detailData = state.changeViewMode.mode.data;\n    }\n    let regionInfo = (state.regionInfo)?state.regionInfo:null;\n    return {\n        stateChange:stateChange,\n        computeRefresh : (state.computeRefresh) ? state.computeRefresh: null,\n        changeRegion : state.changeRegion.region?state.changeRegion.region:null,\n        selectOrg : state.selectOrg.org?state.selectOrg.org:null,\n        userRole : state.showUserRole?state.showUserRole.role:null,\n        viewMode : viewMode, detailData:detailData,\n        headerFilter : state.tableHeader.filter ? state.tableHeader.filter : null,\n        regionInfo: regionInfo\n    }\n};\nconst mapDispatchProps = (dispatch) => {\n    return {\n        handleChangeSite: (data) => { dispatch(actions.changeSite(data))},\n        handleInjectData: (data) => { dispatch(actions.injectData(data))},\n        handleInjectDeveloper: (data) => { dispatch(actions.registDeveloper(data))},\n        handleComputeRefresh: (data) => { dispatch(actions.computeRefresh(data))},\n        handleLoadingSpinner: (data) => { dispatch(actions.loadingSpinner(data))},\n        handleAlertInfo: (mode,msg) => { dispatch(actions.alertInfo(mode,msg))},\n    };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchProps)(sizeMe({ monitorHeight: true })(SiteFourPageAppInst)));\n"]},"metadata":{},"sourceType":"module"}